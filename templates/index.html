{% extends "base.html" %}

{% block title %}Ä°stanbul Su ArÄ±tma Sistemleri | Irmak Su ArÄ±tma - Ãœcretsiz Montaj{% endblock %}

{% block content %}
<!-- Dinamik Banner'lar -->
{% for banner in banners %}
<div class="alert text-center mb-4 py-4 border-0 shadow-sm banner-depth-animation" 
     style="background: linear-gradient(135deg, {{ banner.background_color }}, {{ banner.background_color }}dd, {{ banner.background_color }}aa); color: {{ banner.text_color }};">
    
    <div class="row align-items-center">
        <!-- Sol Ã‡erÃ§eve -->
        <div class="col-md-2">
            <div class="banner-frame left-frame">
                {% if banner.left_image %}
                <img src="{{ url_for('static', filename='images/' + banner.left_image) }}" 
                     alt="Sol Banner Resmi" 
                     class="frame-image">
                {% else %}
                <div class="empty-frame">
                    <i class="fas fa-image"></i>
                    <p>Sol Resim</p>
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Orta Ä°Ã§erik -->
        <div class="col-md-8">
            <h2 class="mb-3 fw-bold water-text" style="color: {{ banner.text_color }};">
                {{ banner.title }}
            </h2>
            {% if banner.subtitle %}
            <p class="mb-2 fs-5 banner-subtitle water-text" style="color: {{ banner.text_color }};">
                {{ banner.subtitle }}
            </p>
            {% endif %}
            {% if banner.description %}
            <p class="mb-3 fs-6 banner-description water-text" style="color: {{ banner.text_color }};">
                {{ banner.description }}
            </p>
            {% endif %}
            {% if banner.button_text and banner.button_link %}
            <a href="{{ banner.button_link }}" class="btn btn-lg px-4 py-2 banner-button-animate" 
               style="background-color: {{ banner.text_color }}; color: {{ banner.background_color }}; border: 2px solid {{ banner.text_color }};">
                {{ banner.button_text }}
            </a>
            {% endif %}
        </div>
        
        <!-- SaÄŸ Ã‡erÃ§eve -->
        <div class="col-md-2">
            <div class="banner-frame right-frame">
                {% if banner.right_image %}
                <img src="{{ url_for('static', filename='images/' + banner.right_image) }}" 
                     alt="SaÄŸ Banner Resmi" 
                     class="frame-image">
                {% else %}
                <div class="empty-frame">
                    <i class="fas fa-image"></i>
                    <p>SaÄŸ Resim</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endfor %}

<!-- Banner Derinlik ve Perspektif AnimasyonlarÄ± -->
<style>
/* Yatay kaydÄ±rmayÄ± engelle */
body {
    overflow-x: hidden;
}

.container {
    overflow-x: hidden;
}

/* Banner temel stil - sÃ¼rekli animasyonlu */
.banner-depth-animation {
    position: relative;
    overflow: hidden;
    opacity: 1;
    transform: translateY(0);
    animation: bannerPulse 4s ease-in-out infinite;
}

/* Banner sÃ¼rekli pulse animasyonu */
@keyframes bannerPulse {
    0%, 100% {
        transform: scale(1) translateY(0);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    50% {
        transform: scale(1.02) translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }
}

/* Ã‡erÃ§eve TasarÄ±mlarÄ± */
.banner-frame {
    width: 100%;
    height: 120px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(5px);
    transition: all 0.3s ease;
    animation: frameFloat 5s ease-in-out infinite;
}

.banner-frame:hover {
    transform: scale(1.05);
    border-color: rgba(255, 255, 255, 0.6);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
}

@keyframes frameFloat {
    0%, 100% {
        transform: translateY(0) rotateY(0deg);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    50% {
        transform: translateY(-3px) rotateY(2deg);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }
}

.left-frame {
    animation-delay: 0s;
}

.right-frame {
    animation-delay: 2.5s;
}

/* Ã‡erÃ§eve iÃ§indeki resim */
.frame-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
    transition: transform 0.3s ease;
}

.frame-image:hover {
    transform: scale(1.1);
}

/* BoÅŸ Ã§erÃ§eve tasarÄ±mÄ± */
.empty-frame {
    text-align: center;
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
}

.empty-frame i {
    font-size: 24px;
    margin-bottom: 8px;
    opacity: 0.6;
}

.empty-frame p {
    margin: 0;
    font-size: 12px;
    opacity: 0.8;
}

/* BaÅŸlÄ±k sÃ¼rekli animasyonu - harfler dÃ¼ÅŸme */
.banner-depth-animation h2 {
    animation: titleFloat 6s ease-in-out infinite;
}

@keyframes titleFloat {
    0%, 100% {
        transform: translateY(0) rotateX(0deg);
    }
    25% {
        transform: translateY(-3px) rotateX(2deg);
    }
    75% {
        transform: translateY(3px) rotateX(-2deg);
    }
}

/* Alt baÅŸlÄ±k sÃ¼rekli bÃ¼yÃ¼me animasyonu */
.banner-subtitle {
    animation: subtitleGrow 5s ease-in-out infinite;
    animation-delay: 0.5s;
}

@keyframes subtitleGrow {
    0%, 100% {
        transform: scale(1) translateY(0);
        opacity: 1;
    }
    50% {
        transform: scale(1.05) translateY(-2px);
        opacity: 0.9;
    }
}

/* AÃ§Ä±klama sÃ¼rekli fade animasyonu */
.banner-description {
    animation: descriptionFade 7s ease-in-out infinite;
    animation-delay: 1s;
}

@keyframes descriptionFade {
    0%, 100% {
        opacity: 0.8;
        transform: translateX(0);
    }
    50% {
        opacity: 1;
        transform: translateX(2px);
    }
}

/* Buton sÃ¼rekli bounce animasyonu */
.banner-button-animate {
    animation: buttonBounce 3s ease-in-out infinite;
    animation-delay: 1.5s;
}

@keyframes buttonBounce {
    0%, 100% {
        transform: translateY(0) scale(1);
    }
    25% {
        transform: translateY(-3px) scale(1.02);
    }
    75% {
        transform: translateY(2px) scale(0.98);
    }
}

/* Gradient arka plan animasyonu */
.banner-depth-animation {
    background-size: 200% 200%;
    animation: gradientShift 8s ease infinite, bannerPulse 4s ease-in-out infinite;
}

@keyframes gradientShift {
    0% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
    100% {
        background-position: 0% 50%;
    }
}

/* Mobil uyumluluk */
@media (max-width: 768px) {
    .banner-frame {
        height: 80px;
        margin-bottom: 15px;
    }
    
    .empty-frame i {
        font-size: 18px;
    }
    
    .empty-frame p {
        font-size: 10px;
    }
}
</style>

<!-- GerÃ§ekÃ§i Su Efekti Scripti -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // TÃ¼m banner'larÄ± hemen gÃ¶rÃ¼nÃ¼r yap
    document.querySelectorAll('.banner-depth-animation').forEach(banner => {
        banner.classList.add('visible');
        
        // Su damlasÄ± efekti ekle
        addWaterDropEffect(banner);
        
        // GerÃ§ekÃ§i yazÄ± animasyonlarÄ±
        const waterTexts = banner.querySelectorAll('.water-text');
        waterTexts.forEach((text, index) => {
            // Orijinal metni sakla
            const originalText = text.textContent;
            text.setAttribute('data-text', originalText);
            
            // GerÃ§ekÃ§i harf dÃ¶kÃ¼lme animasyonu
            setTimeout(() => {
                text.style.animationDelay = `${index * 0.5}s`;
                text.classList.add('water-flowing');
                
                // Harfleri gerÃ§ekÃ§i ÅŸekilde dÃ¶k
                setTimeout(() => {
                    createRealisticLetterDrop(text, originalText);
                }, 1500); // Su akÄ±ÅŸÄ± baÅŸladÄ±ktan sonra
                
            }, index * 800);
        });
        
        // Musluk animasyonunu baÅŸlat
        const tapContainer = banner.querySelector('.water-tap-container');
        if (tapContainer) {
            setTimeout(() => {
                tapContainer.classList.add('tap-active');
            }, 300);
        }
    });
    
    // GerÃ§ekÃ§i su akÄ±ÅŸÄ± dÃ¶ngÃ¼sÃ¼
    setInterval(() => {
        document.querySelectorAll('.water-text').forEach((text, index) => {
            // Hafif titreÅŸim efekti
            addRealisticWaterEffect(text, index * 300);
            
            // Harfleri yeniden dÃ¶k (daha az sÄ±klÄ±kta)
            if (Math.random() > 0.7) { // %30 ÅŸans
                setTimeout(() => {
                    const originalText = text.getAttribute('data-text');
                    if (originalText) {
                        createRealisticLetterDrop(text, originalText);
                    }
                }, index * 500);
            }
        });
    }, 12000); // 12 saniyede bir
});

function addWaterDropEffect(banner) {
    const tapContainer = banner.querySelector('.water-tap-container');
    if (!tapContainer) return;
    
    // Su damlasÄ± elementleri oluÅŸtur
    for (let i = 0; i < 3; i++) {
        const dropElement = document.createElement('div');
        dropElement.className = 'water-drop-effect';
        dropElement.style.animationDelay = `${i * 0.8}s`;
        tapContainer.appendChild(dropElement);
    }
}

function createRealisticLetterDrop(textElement, originalText) {
    if (!originalText) return;
    
    // Harfleri gerÃ§ekÃ§i ÅŸekilde bÃ¶l
    const letters = originalText.split('').map((letter, letterIndex) => {
        if (letter === ' ') return ' ';
        
        const delay = letterIndex * 0.08; // Daha hÄ±zlÄ± dÃ¶kÃ¼lme
        const randomOffset = (Math.random() - 0.5) * 10; // Rastgele sapma
        
        return `<span class="letter-drop" 
                      style="animation-delay: ${delay}s; 
                             transform: translateX(${randomOffset}px);
                             opacity: 0;">${letter}</span>`;
    }).join('');
    
    textElement.innerHTML = letters;
    
    // Harflerin animasyonunu baÅŸlat
    const letterSpans = textElement.querySelectorAll('.letter-drop');
    letterSpans.forEach((span, letterIndex) => {
        setTimeout(() => {
            span.style.opacity = '1';
            span.style.animation = `realisticLetterDrop 3s ease-out forwards`;
        }, letterIndex * 80);
    });
}

function addRealisticWaterEffect(element, delay) {
    setTimeout(() => {
        // Hafif titreÅŸim
        element.style.transform = 'translateY(-1px) translateX(0.5px)';
        element.style.filter = 'brightness(1.05) contrast(1.02)';
        
        setTimeout(() => {
            element.style.transform = 'translateY(0) translateX(0)';
            element.style.filter = 'brightness(1) contrast(1)';
        }, 200);
    }, delay);
}

// Musluk tÄ±klama efekti - gerÃ§ekÃ§i
document.addEventListener('click', function(e) {
    if (e.target.classList.contains('water-tap-image')) {
        // Musluk tÄ±klandÄ±ÄŸÄ±nda gÃ¼Ã§lÃ¼ su akÄ±ÅŸÄ±
        const tapContainer = e.target.parentElement;
        const waterStream = tapContainer.querySelector('.water-stream');
        
        if (waterStream) {
            // GeÃ§ici gÃ¼Ã§lÃ¼ akÄ±ÅŸ
            waterStream.style.animation = 'realWaterFlow 1.5s ease-in-out';
            waterStream.style.opacity = '1';
            waterStream.style.height = '80px';
            waterStream.style.width = '4px';
            
            setTimeout(() => {
                waterStream.style.animation = 'realWaterFlow 4s ease-in-out infinite';
                waterStream.style.opacity = '';
                waterStream.style.height = '';
                waterStream.style.width = '';
            }, 1500);
        }
        
        // Ekstra su damlalarÄ± oluÅŸtur
        createExtraWaterDrops(tapContainer);
        
        // TÃ¼m yazÄ±larÄ± anÄ±nda yeniden dÃ¶k
        const banner = tapContainer.closest('.banner-depth-animation');
        const waterTexts = banner.querySelectorAll('.water-text');
        waterTexts.forEach((text, index) => {
            setTimeout(() => {
                const originalText = text.getAttribute('data-text');
                if (originalText) {
                    createRealisticLetterDrop(text, originalText);
                }
            }, index * 200);
        });
    }
});

function createExtraWaterDrops(tapContainer) {
    for (let i = 0; i < 5; i++) {
        const extraDrop = document.createElement('div');
        extraDrop.className = 'water-drop-effect';
        extraDrop.style.animationDelay = `${i * 0.2}s`;
        extraDrop.style.left = `${110 + (Math.random() - 0.5) * 10}px`;
        extraDrop.style.animationDuration = '1.5s';
        tapContainer.appendChild(extraDrop);
        
        // 3 saniye sonra kaldÄ±r
        setTimeout(() => {
            if (extraDrop.parentNode) {
                extraDrop.parentNode.removeChild(extraDrop);
            }
        }, 3000);
    }
}

// Sayfa yÃ¼klendiÄŸinde gerÃ§ekÃ§i efektler
window.addEventListener('load', function() {
    // TÃ¼m musluklarÄ± hafifÃ§e titret
    document.querySelectorAll('.water-tap-image').forEach(tap => {
        tap.style.transition = 'all 0.3s ease';
    });
    
    // Su sesini simÃ¼le et (gÃ¶rsel olarak)
    setInterval(() => {
        document.querySelectorAll('.water-stream').forEach(stream => {
            if (Math.random() > 0.8) { // %20 ÅŸans
                stream.style.opacity = '0.95';
                setTimeout(() => {
                    stream.style.opacity = '';
                }, 100);
            }
        });
    }, 2000);
});
</script>

<div class="container">
    <!-- SEO iÃ§in H1 etiketi -->
    <h1 class="text-center mb-4">Ä°stanbul'da Profesyonel Su ArÄ±tma Sistemleri ve Filtre Hizmetleri</h1>
    
    <!-- SEO iÃ§in aÃ§Ä±klayÄ±cÄ± paragraf -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="card p-4">
                <p class="lead text-center">Ä°stanbul'da 15 yÄ±llÄ±k deneyimimizle su arÄ±tma sistemleri kurulumu, filtre deÄŸiÅŸimi ve bakÄ±m hizmetleri sunuyoruz. TÃ¼m marka su filtrelerinin yedek parÃ§alarÄ± mevcuttur. Ãœcretsiz keÅŸif ve montaj hizmeti ile 2 yÄ±l garanti veriyoruz.</p>
                
                <!-- Gizli SEO metni -->
                <div class="d-none">
                    Ä°stanbul su arÄ±tma, Avrupa yakasÄ± su filtresi, Anadolu yakasÄ± su arÄ±tma sistemi, BaÅŸakÅŸehir su filtresi deÄŸiÅŸimi, BeylikdÃ¼zÃ¼ su arÄ±tma, Esenyurt filtre bakÄ±mÄ±, KÃ¼Ã§Ã¼kÃ§ekmece su arÄ±tma servisi, BahÃ§elievler su filtresi, BakÄ±rkÃ¶y su arÄ±tma sistemleri, Zeytinburnu filtre deÄŸiÅŸimi, su arÄ±tma yedek parÃ§a Ä°stanbul, reverse osmosis Ä°stanbul, ultrafiltrasyon sistemi, karbon filtre deÄŸiÅŸimi, sediment filtre Ä°stanbul
                </div>
            </div>
        </div>
    </div>

    <h2 class="text-center mb-4">Su ArÄ±tma ÃœrÃ¼nlerimiz</h2>
    
    <div class="row">
        {% for product in products %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="text-center p-3" style="background-color: #f8f9fa;">
                    <img src="{{ product.image }}" class="img-fluid" alt="{{ product.name }} - Ä°stanbul Su ArÄ±tma Sistemi | Irmak Su ArÄ±tma" style="max-height: 180px; width: auto;">
                </div>
                <div class="card-body">
                    <h5 class="card-title">{{ product.name }}</h5>
                    <p class="card-text">{{ product.description }}</p>
                    <p class="card-text"><strong>Fiyat: {{ product.price }} TL</strong></p>
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('product_detail', product_id=product.id) }}" class="btn btn-outline-primary">DetaylarÄ± GÃ¶r</a>
                        <button class="btn btn-success" onclick="buyNow('{{ product.name }}', '{{ product.price }}')">
                            <i class="fas fa-credit-card me-2"></i>Hemen SatÄ±n Al
                        </button>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function buyNow(productName, price) {
    // Ã–deme modalÄ±nÄ± aÃ§
    showPaymentModal(productName, price);
}

function showPaymentModal(productName, price) {
    const modal = `
        <div class="modal fade" id="paymentModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">ğŸ’³ GÃ¼venli Ã–deme</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="text-center mb-3">
                            <h6>${productName}</h6>
                            <h4 class="text-success">${price} TL</h4>
                        </div>
                        
                        <div class="payment-options">
                            <button class="btn btn-primary w-100 mb-2" onclick="payWithCard()">
                                <i class="fas fa-credit-card me-2"></i>Kredi KartÄ± ile Ã–de
                            </button>
                            <button class="btn btn-success w-100 mb-2" onclick="payWithWhatsApp('${productName}', '${price}')">
                                <i class="fab fa-whatsapp me-2"></i>WhatsApp ile SipariÅŸ Ver
                            </button>
                            <button class="btn btn-info w-100" onclick="callForOrder()">
                                <i class="fas fa-phone me-2"></i>Telefon ile SipariÅŸ Ver
                            </button>
                        </div>
                        
                        <div class="mt-3 text-center">
                            <small class="text-muted">
                                ğŸ”’ SSL ile korumalÄ± Ã¶deme<br>
                                ğŸ’³ TÃ¼m kredi kartlarÄ± kabul edilir<br>
                                ğŸšš Ãœcretsiz montaj dahil
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Modal'Ä± sayfaya ekle
    document.body.insertAdjacentHTML('beforeend', modal);
    
    // Modal'Ä± gÃ¶ster
    const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'));
    paymentModal.show();
    
    // Modal kapandÄ±ÄŸÄ±nda DOM'dan kaldÄ±r
    document.getElementById('paymentModal').addEventListener('hidden.bs.modal', function() {
        this.remove();
    });
}

function payWithCard() {
    // iyzico Ã¶deme sayfasÄ±na yÃ¶nlendir (gerÃ§ek entegrasyon sonrasÄ±)
    alert('ğŸ”„ Kredi kartÄ± Ã¶deme sistemi hazÄ±rlanÄ±yor...\n\nâœ… SSL gÃ¼venliÄŸi\nâœ… 3D Secure\nâœ… AnÄ±nda onay\n\nÅimdilik WhatsApp ile sipariÅŸ verebilirsiniz!');
}

function payWithWhatsApp(productName, price) {
    const message = encodeURIComponent(`ğŸ›’ SÄ°PARÄ°Å DETAYI\n\nğŸ“¦ ÃœrÃ¼n: ${productName}\nğŸ’° Fiyat: ${price} TL\nğŸšš Ãœcretsiz montaj dahil\n\nSipariÅŸ vermek istiyorum. Ã–deme seÃ§eneklerini Ã¶ÄŸrenebilir miyim?`);
    window.open(`https://wa.me/905448113105?text=${message}`, '_blank');
}

function callForOrder() {
    alert('ğŸ“ Hemen arayÄ±n: 0544 811 31 05\n\nâ° Ã‡alÄ±ÅŸma saatleri:\nPazartesi - Cumartesi: 09:00 - 18:00');
}
</script>
{% endblock %}